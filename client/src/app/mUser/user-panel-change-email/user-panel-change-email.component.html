<ng-container *ngIf="isVisible">
  <form
    [formGroup]="changeEmailForm"
    (submit)="onEmailChange()"
    [ngClass]=""
    class="form">
    <mat-form-field appearance="outline"
                    class="form-white-input-field
                  input-field
                  hidden
                  error-margin"
                    [ngClass]="{
                  'form-valid-field':changeEmailForm.controls.email.valid,
                   'visible':isChangeEmailFormVisible,
                   'error-margin':!isValidForm && changeEmailForm.controls.email.touched}">
      <mat-label>Email адрес</mat-label>
      <mat-error>Въведеният email адрес е невалиден.</mat-error>
      <input matInput
             placeholder="Email адрес"
             formControlName="email">
      <mat-icon
        matSuffix
        mat-icon-button>
        <svg xmlns="http://www.w3.org/2000/svg"
             viewBox="0 0 512 512"
             class="form-input-field-svg">
          <path
            d="M256 64C150 64 64 150 64 256s86 192 192 192c17.7 0 32 14.3 32 32s-14.3 32-32 32C114.6 512 0 397.4 0 256S114.6 0 256 0S512 114.6 512 256v32c0 53-43 96-96 96c-29.3 0-55.6-13.2-73.2-33.9C320 371.1 289.5 384 256 384c-70.7 0-128-57.3-128-128s57.3-128 128-128c27.9 0 53.7 8.9 74.7 24.1c5.7-5 13.1-8.1 21.3-8.1c17.7 0 32 14.3 32 32v80 32c0 17.7 14.3 32 32 32s32-14.3 32-32V256c0-106-86-192-192-192zm64 192a64 64 0 1 0 -128 0 64 64 0 1 0 128 0z"/>
        </svg>
      </mat-icon>
    </mat-form-field>

    <div class="form-buttons">
      <div class="button-wrapper"
           [ngClass]="{'error-padding':!isValidForm && changeEmailForm.controls.email.touched}"
           *ngIf="isChangeEmailFormVisible">

        <button
          type="submit"
          [disabled]="!isValidForm"
          class="clickable form-clear-button-style centered">
          <app-text-button
            [buttonText]="'Промяна'"
            [isDisabled]="!isValidForm">
          </app-text-button>
        </button>

        <app-text-button
          [buttonText]="'Отказ'"
          class="centered button"
          (click)="onEmailChangeCancel()"
        ></app-text-button>
      </div>

      <div class="button-wrapper centered" *ngIf="!isChangeEmailFormVisible">
        <app-text-button
          class="centered button change-button"
          [buttonText]="'Промяна на email'"
          (click)="onEmailEdit()"
        ></app-text-button>
      </div>
    </div>
  </form>
</ng-container>
